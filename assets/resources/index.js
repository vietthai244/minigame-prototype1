System.register("chunks:///_virtual/GameItemTemplate.ts",["./rollupPluginModLoBabelHelpers.js","cc","./AssetsController.ts"],(function(e){var t,r,n,o,a,s,i,c,p,u;return{setters:[function(e){t=e.inheritsLoose,r=e.asyncToGenerator,n=e.regeneratorRuntime},function(e){o=e.cclegacy,a=e._decorator,s=e.Component,i=e.error,c=e.UITransform,p=e.Sprite},function(e){u=e.AssetsController}],execute:function(){var l;o._RF.push({},"d3000yZpZ5J2o9rDES51AUc","GameItemTemplate",void 0);var m=a,h=m.ccclass;m.property,e("GameItemTemplate",h("GameItemTemplate")(l=function(e){function o(){for(var t,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(t=e.call.apply(e,[this].concat(n))||this).isDestroyed=!1,t.data=null,t}t(o,e);var a=o.prototype;return a.updateData=function(){var e=r(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.data=t,e.next=4,u.applySpriteFrame(this.node.getComponent(p),t.assetPath);case 4:this.node.getComponent(c).setContentSize(16,32),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),i("Error Updating game item",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),a.remove=function(){var e=this;this.isDestroyed||(this.isDestroyed=!0,setTimeout((function(){return e.node.destroy()}),100))},o}(s))||l);o._RF.pop()}}}));

System.register("chunks:///_virtual/PlayerTemplate.ts",["./rollupPluginModLoBabelHelpers.js","cc","./config.ts","./GameItemTemplate.ts","./AssetsController.ts","./GameEvent.ts","./WeaponTemplate.ts"],(function(e){var t,n,a,o,i,r,s,c,h,p,u,l,d,m,f,g,w,C,v,y,b,T;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,a=e.initializerDefineProperty,o=e.assertThisInitialized,i=e.asyncToGenerator,r=e.regeneratorRuntime},function(e){s=e.cclegacy,c=e.Sprite,h=e.Node,p=e.Prefab,u=e._decorator,l=e.Collider2D,d=e.Contact2DType,m=e.UITransform,f=e.misc,g=e.Vec3,w=e.Component},function(e){C=e.MAP_SIZE},function(e){v=e.GameItemTemplate},function(e){y=e.AssetsController},function(e){b=e.GameEvent},function(e){T=e.WeaponTemplate}],execute:function(){var D,I,M,k,P,x,N,R,W;s._RF.push({},"18c1ddAko5JC4hBkRiVrcmg","PlayerTemplate",void 0);var E=u,A=E.ccclass,S=E.property;e("PlayerTemplate",(D=A("PlayerTemplate"),I=S(c),M=S(h),k=S(p),D((N=t((x=function(e){function t(){for(var t,n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return t=e.call.apply(e,[this].concat(i))||this,a(t,"character",N,o(t)),a(t,"weaponsContainer",R,o(t)),a(t,"weaponPrefab",W,o(t)),t.data=void 0,t.isBot=!1,t.isDead=!1,t.currentTarget=null,t.minMoveDistance=50,t.maxMoveDistance=500,t.moveSpeed=200,t.rotationSpeed=300,t.weaponNodes=[],t.weaponCount=0,t.maxWeaponCount=15,t.currentItem=null,t.locked=!1,t.contactCoolDown=0,t}n(t,e);var s=t.prototype;return s.start=function(){this.init(),this.arrangeWeapons()},s.update=function(e){this.animateWeapons(e),this.moveBot(e),this.contactCoolDown>0&&(this.contactCoolDown-=e)},s.init=function(){var e="/images/PlayableCharacters-"+Math.round(4*Math.random())+"/spriteFrame";y.applySpriteFrame(this.character,e),this.getComponent(l).on(d.BEGIN_CONTACT,this.onBeginContact,this)},s.setPlayer=function(e){this.data=e},s.setBot=function(e){this.isBot=e,e&&this.setRandomTarget()},s.onBeginContact=function(e,t,n){try{t.node.getComponent(v)&&this.grabItem(t.node);var a=t.node.getComponent(T);a&&a.owner.data.id!==this.data.id&&this.die()}catch(e){console.log("ERROR PLAYER COLLISION:",e)}},s.die=function(){var e=this;this.locked=!0,setTimeout((function(){e.isDead=!0,e.currentTarget=null,e.node.active=!1,e.weaponsContainer.removeAllChildren(),e.weaponNodes=[],b.playerDie.emit(e)}),1)},s.grabItem=function(){var e=i(r().mark((function e(t){var n,a=this;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=t.getComponent(v)).isDestroyed){e.next=3;break}return e.abrupt("return");case 3:if(this.currentItem){e.next=7;break}this.currentItem=n.data,e.next=15;break;case 7:if(!(this.currentItem.id!==n.data.id&&this.currentItem.rank<n.data.rank)){e.next=15;break}return this.locked=!0,this.currentItem=n.data,this.weaponCount=0,b.grabItem.emit({itemNode:t,player:this}),n.remove(),setTimeout((function(){a.weaponsContainer.removeAllChildren(),a.weaponNodes=[],a.addWeapon(),a.locked=!1}),1),e.abrupt("return");case 15:if(b.grabItem.emit({itemNode:t,player:this}),n.remove(),!(this.currentItem.rank<=n.data.rank)){e.next=20;break}return e.next=20,this.addWeapon();case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),s.addWeapon=function(){var e=i(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.weaponCount<this.maxWeaponCount)){e.next=11;break}return e.next=3,y.loadPrefab("/prefabs/Weapon");case 3:return t=e.sent,e.next=6,y.applySpriteFrame(t.getComponent(c),this.currentItem.assetPath);case 6:t.getComponent(T).setData(this.currentItem,this),this.weaponsContainer.addChild(t),this.weaponNodes.push(t),this.weaponCount++,this.arrangeWeapons();case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),s.removeWeapon=function(){var e=this;this.locked||this.contactCoolDown>0||(this.locked=!0,this.contactCoolDown=.3,console.log("WEAPON CONTACTED"),setTimeout((function(){try{if(e.weaponCount=Math.min(e.weaponCount-1,0),e.weaponNodes.length)e.weaponNodes.shift().destroy(),e.weaponNodes=e.weaponNodes.slice(1);e.arrangeWeapons(),e.weaponNodes.length||(e.currentItem=null),e.locked=!1}catch(e){console.log("ERROR removing weapon",e)}}),1))},s.arrangeWeapons=function(){try{var e=this.weaponsContainer.getComponent(m).width/2,t=360/this.weaponCount;this.weaponNodes.forEach((function(n,a){var o=n.getComponent(m).height,i=f.degreesToRadians(a*t),r=(e+o)*Math.cos(i),s=(e+o)*Math.sin(i);n.setPosition(r,s);var c=a*t;n.angle=c-90}))}catch(e){console.log("ERROR RENDERING WEAPONS",e)}},s.animateWeapons=function(e){this.isDead||!this.locked&&this.weaponsContainer.children.length&&(this.weaponsContainer.angle+=this.rotationSpeed*e,this.weaponsContainer.angle>360?this.weaponsContainer.angle-=360:this.weaponsContainer.angle<0&&(this.weaponsContainer.angle+=360))},s.setRandomTarget=function(){var e=this.node.getPosition(),t=this.minMoveDistance+Math.random()*(this.maxMoveDistance-this.minMoveDistance),n=Math.random()*Math.PI*2,a=e.x+t*Math.cos(n),o=e.y+t*Math.sin(n),i=Math.max(-C.width/2,Math.min(C.width/2,a)),r=Math.max(-C.height/2,Math.min(C.height/2,o));this.currentTarget=new g(i,r,0)},s.moveBot=function(e){if(this.isBot&&!this.isDead&&this.currentTarget){var t=this.node.getPosition().clone(),n=this.currentTarget.clone().subtract(t).normalize().multiplyScalar(this.moveSpeed*e),a=t.add(n);this.node.setPosition(a),this.getDistance(a,this.currentTarget)<10&&this.setRandomTarget()}},s.getDistance=function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},t}(w)).prototype,"character",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=t(x.prototype,"weaponsContainer",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(x.prototype,"weaponPrefab",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=x))||P));s._RF.pop()}}}));

System.register("chunks:///_virtual/resources",["./GameItemTemplate.ts","./PlayerTemplate.ts","./WeaponTemplate.ts"],(function(){return{setters:[null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/WeaponTemplate.ts",["./rollupPluginModLoBabelHelpers.js","cc","./GameItemTemplate.ts"],(function(e){var t,n,o,r,a,i,s,c,p,d,u;return{setters:[function(e){t=e.inheritsLoose,n=e.asyncToGenerator,o=e.regeneratorRuntime},function(e){r=e.cclegacy,a=e.RigidBody2D,i=e.BoxCollider2D,s=e.Contact2DType,c=e.Collider2D,p=e._decorator,d=e.Component},function(e){u=e.GameItemTemplate}],execute:function(){var l;r._RF.push({},"d1e9f74NtRKAoOXmfAPwPmF","WeaponTemplate",void 0);var h=p,m=h.ccclass;h.property,e("WeaponTemplate",m("WeaponTemplate")(l=function(e){function r(){for(var t,n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(t=e.call.apply(e,[this].concat(o))||this).data=void 0,t.owner=null,t.collider=void 0,t.rigidBody=void 0,t}t(r,e);var p=r.prototype;return p.start=function(){this.init()},p.init=function(){this.rigidBody=this.getComponent(a),this.collider=this.getComponent(i),this.collider.on(s.BEGIN_CONTACT,this.onBeginContact,this)},p.onDestroyed=function(){this.getComponent(c).off(s.BEGIN_CONTACT)},p.setData=function(e,t){this.data=e,this.owner=t,this.node.setScale(e.size,e.size)},p.onBeginContact=function(){var e=n(o().mark((function e(t,n,a){var i,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(i=n.node.getComponent(u))||i.isDestroyed){e.next=5;break}return e.next=5,this.owner.grabItem(n.node);case 5:if(!(s=n.node.getComponent(r))||s.owner.data.id===this.owner.data.id){e.next=16;break}e.t0=!0,e.next=e.t0===(this.data.rank===s.data.rank)?10:e.t0===this.data.rank>s.data.rank?13:e.t0===this.data.rank<s.data.rank?15:16;break;case 10:return s.owner.removeWeapon(),this.owner.removeWeapon(),e.abrupt("break",16);case 13:return s.owner.removeWeapon(),e.abrupt("break",16);case 15:this.owner.removeWeapon();case 16:e.next=21;break;case 18:e.prev=18,e.t1=e.catch(0),console.log("ERROR WEAPON COLLISION:",e.t1);case 21:case"end":return e.stop()}}),e,this,[[0,18]])})));return function(t,n,o){return e.apply(this,arguments)}}(),r}(d))||l);r._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/resources', 'chunks:///_virtual/resources'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});